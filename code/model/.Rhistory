lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=5)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=5)
summary(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG); sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG); sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG); sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG); sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(ds$SBRCY); sd(ds$SBRCY)
mean(ds$GOOG); sd(ds$GOOG)
mean(ds$GSPC); sd(ds$GSPC)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG); sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG); sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) - 0.5* sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) - 0.5* sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) - 0.2* sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) - 0.2* sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) - 0.2* sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) - 0.2* sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) - 0.1* sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) - 0.1* sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.2*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.2*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# sell SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# sell SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# sell SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# sell SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = ds$SBRCY[i-1]/(ds$SBRCY[i-1] + ds$GOOG[i-1]) #  0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# sell SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# sell SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
w
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = min(0,ds$SBRCY[i-1]/(ds$SBRCY[i-1] + ds$GOOG[i-1])) #  0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# sell SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# sell SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
w
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = max(0,ds$SBRCY[i-1]/(ds$SBRCY[i-1] + ds$GOOG[i-1])) #  0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# sell SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# sell SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
w
1/(ds$SBRCY+ ds$GOOG)
1/(ds$SBRCY - ds$GOOG)
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 1 #  0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 1#0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# sell SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# sell SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 1 #  0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 1#0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# buy SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 1 #  0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 1#0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# buy SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=5)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
# buy SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 1 #  0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 1#0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# buy SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# buy SBRCY when its DOWN
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its UP
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# buy SBRCY when its UP
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its DOWN
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=5)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=5)
# buy SBRCY when its UP
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its DOWN
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 2*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 2*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# buy SBRCY when its UP
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# buy SBRCY when its DOWN
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
# when SBRCY is DOWN, I sell it
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# when SBRCY is DOWN, I buy it
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 0.5*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 0.5*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# when SBRCY is DOWN, I sell it
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# when SBRCY is DOWN, I buy it
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=5)
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 0.1*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 0.1*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# when SBRCY is DOWN, I sell it
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# when SBRCY is DOWN, I buy it
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=5)
# when SBRCY is DOWN, I sell it
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# when SBRCY is DOWN, I buy it
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 0*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 0*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# when SBRCY is DOWN, I sell it
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# when SBRCY is DOWN, I buy it
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=5)
w
i=2
ds$SBRCY[i-1] < ds$GOOG[i-1]
w = matrix(0.5,ncol = 2,nrow = n)
for (i in 2:n)
{
# browser()
if (ds$SBRCY[i-1] < ds$GOOG[i-1])
{
w[i,1] = 0*w[i-1,1]
w[i,2] = 1 - w[i,1]
}
else {
w[i,2] = 0*w[i-1,2]
w[i,1] = 1-w[i,2]
}
# when SBRCY is DOWN, I sell it
mean(w[,1]*ds$SBRCY + w[,2]*ds$GOOG) -  0.3*sd(w[,1]*ds$SBRCY + w[,2]*ds$GOOG)
# when SBRCY is DOWN, I buy it
mean(w[,2]*ds$SBRCY + w[,1]*ds$GOOG) -  0.3*sd(w[,2]*ds$SBRCY + w[,1]*ds$GOOG)
plot(ds$date,cumsum(ds$GSPC), type='l', col=1, ylim=c(-70,120))
lines(ds$date,cumsum(ds$GOOG), type='l', col=2)
lines(ds$date,cumsum(ds$SBRCY), type='l', col=3)
lines(ds$date,cumsum(w[,1]*ds$SBRCY + w[,2]*ds$GOOG), type='l', col=4)
lines(ds$date,cumsum(w[,2]*ds$SBRCY + w[,1]*ds$GOOG), type='l', col=5)
w = matrix(0.5,ncol = 2,nrow = n)
i=2
ds$SBRCY[i-1] < ds$GOOG[i-1]
ds$SBRCY[i-1]
ds$GOOG[i-1]
w[i,1] = 0*w[i-1,1]
w[i,2] = 1 - w[i,1]
w[1:3,]
i-3
i=3
ds$GOOG[i-1]
ds$SBRCY[i-1]
install.packages("drat", repos="https://cran.rstudio.com")
drat:::addRepo("dmlc")
install.packages("xgboost", repos="http://dmlc.ml/drat/", type = "source")
# install.packages("xgboost", repos="http://dmlc.ml/drat/", type = "source")
install.packages("xgboost")
setwd("~/Dropbox/prj/hospital/")
write.csv(x = d,file = "data/hosp.csv")
library(tidyverse)
d = read_csv("data/KaggleV2-May-2016.csv")
names(d)[14]="noshow"
unique(d$noshow)
d = mutate(d,noshow = as.numeric(factor(noshow))-1) # No = 0 and Yes = 1
d = mutate(d, Neighbourhood = factor(Neighbourhood)) # converst Neighbourhood to fator
write.csv(x = d,file = "data/hosp.csv")
write.csv(x = d,file = "data/hosp.csv", row.names = F)
names(d)
head(d)
# actual
x = seq(-2,2,length.out = 100)
y = 0.5*x^3+1 + rnorm(100, sd=.5)
plot(x,y, type='p', pch=20, lwd=3)
plot(log(x),log(y), type='p', pch=20, lwd=3)
plot(x.log(y), type='p', pch=20, lwd=3)
plot(x,log(y), type='p', pch=20, lwd=3)
y = 0.5*x^3 + rnorm(100, sd=.5)
plot(x,log(y), type='p', pch=20, lwd=3)
plot(x,y, type='p', pch=20, lwd=3)
plot(log(x),log(y), type='p', pch=20, lwd=3)
y = 0.5*x^3# + rnorm(100, sd=.5)
plot(log(x),log(y), type='p', pch=20, lwd=3)
y = 0.5*x^3 + rnorm(100, sd=.5)
plot(log(x),log(y), type='p', pch=20, lwd=3)
plot(log(x),y, type='p', pch=20, lwd=3)
plot(log(x),log(y), type='p', pch=20, lwd=3)
y = 0.5*(x^3 + rnorm(100, sd=.5))
plot(log(x),log(y), type='p', pch=20, lwd=3)
# actual
x = seq(-2,2,length.out = 100)
# actual
x = seq(-2,2,length.out = 100)
y = x^3 + rnorm(100, sd=.5)
plot(log(x),log(y), type='p', pch=20, lwd=3)
y = x^3*rnorm(100, sd=.5)
plot(log(x),log(y), type='p', pch=20, lwd=3)
y = x^3*rnorm(100, sd=.5)
plot(x,y, type='p', pch=20, lwd=3)
# actual
x = seq(-2,2,length.out = 100)
y = x^3*rnorm(100, sd=.5)
plot(x,y, type='p', pch=20, lwd=3)
y = x^3+rnorm(100, sd=.5)
plot(x,y, type='p', pch=20, lwd=3)
y = x^3*rnorm(100, sd=.5)
plot(x,y, type='p', pch=20, lwd=3)
plot(log(x),log(y), type='p', pch=20, lwd=3)
# actual
x = seq(-2,2,length.out = 100)
y = x^3+rnorm(100, sd=.5)
plot(log(x),log(y), type='p', pch=20, lwd=3)
# actual
x = seq(-2,2,length.out = 100)
y = x^3+rnorm(100, sd=.5)
plot(log(x),log(y), type='p', pch=20, lwd=3)
plot(x),log(y), type='p', pch=20, lwd=3)
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,y, type='p', pch=20, lwd=3)
y = exp(x)+3 + rnorm(100,sd=0.3)
plot(x,y, type='p', pch=20, lwd=3)
plot(x,y%>%log(), type='p', pch=20, lwd=3)
y = exp(x)+3 + rnorm(100,sd=0.3)
plot(x,y%>%log(), type='p', pch=20, lwd=3)
plot(x,log(y), type='p', pch=20, lwd=3)
utils$save_pdf(path = "~/ugpa/hw/",name = "exp")
y = exp(x)+3 + rnorm(100,sd=0.3)
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,y, type='p', pch=20, lwd=3)
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,y, type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,y, type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x)+3 + rnorm(100,sd=0.3)
plot(x,log(y), type='p', pch=20, lwd=3)
utils$save_pdf(path = "~/ugpa/hw/",name = "exp")
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,log(y), type='p', pch=20, lwd=3)
plot(log(x),log(y), type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(log(x),log(y), type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(log(x),log(y), type='p', pch=20, lwd=3)
plot(x,log(y), type='p', pch=20, lwd=3)
plot(log(x),log(y), type='p', pch=20, lwd=3)
plot(log(x),y, type='p', pch=20, lwd=3)
y = exp(x)*rnorm(100,sd=0.8)+3
plot(log(x),y, type='p', pch=20, lwd=3)
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x)*rnorm(100,sd=0.8)+3
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x)*rnorm(100,sd=0.8)+3
y = (exp(x)+3)*(1+rnorm(100,sd=0.8))
plot(x,log(y), type='p', pch=20, lwd=3)
y = (exp(x)+3)*(1+rnorm(100,sd=0.2))
plot(x,log(y), type='p', pch=20, lwd=3)
plot(x,y, type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))+3
plot(x,y, type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))*3
plot(x,y, type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))*3
plot(x,y, type='p', pch=20, lwd=3)
plot(x,log(y), type='p', pch=20, lwd=3)
y = exp(x+rnorm(100,sd=0.8))*3
plot(x,log(y), type='p', pch=20, lwd=3)
library(forecast)
library(glmnet)
library(tidyverse)
setwd("/Users/vsokolov/Dropbox/prj/dl-graph/code/model")
d = read.csv("3.csv")
head(d)
mu = mean(d$log_ret_y)
yts = ts(data = d$log_ret_y,start = 1,frequency = 1)
tsm = auto.arima(y = yts, xreg =  d[,1:5] %>% as.matrix())
summary(tsm)
lmod = lm(log_ret_y~., data=d)
summary(lmod)
plot(lmod)
sqrt(mean((mu - d$log_ret_y)^2))
sqrt(mean((tsm$fitted - yts)^2))
sqrt(mean((glmpred - d$log_ret_y)^2))
sqrt(mean((lmod$fitted.values - d$log_ret_y)^2))
library(quantmod)
library(tidyverse)
data.env <- new.env()
# smb = c("^GSPC","FSIVX","^DJI","^IXIC","OROCF","BABA","IEUS","JD","SBRCY", "YNDX","GOOG", "ALB","INTC","NKTR","NVDA", "BRK-B")
smb = c("DVMT")
getSymbols(smb,src="yahoo",env=data.env, from="1900-01-01")
strategy = function(s)
{
tk = sub("^","",s,fixed = TRUE)
tmp = data.env[[tk]]
date = index(tmp)
tmp = as.matrix(tmp)
n = dim(tmp)[1]
#names: "DJI.Open"     "DJI.High"     "DJI.Low"      "DJI.Close"    "DJI.Volume"   "DJI.Adjusted"
opop = c(NA,tmp[-1,1]/tmp[-n,1])
clcl = c(NA,tmp[-1,4]/tmp[-n,4]) # same as opop
opcl = tmp[,4]/tmp[,1]
clop = c(NA,tmp[-1,1]/tmp[-n,4]) # buy on close, sell on open
hold = c(NA, tmp[-1,1]/tmp[1,1]) #same as opop
d = data.frame(date,opop,opcl,clop,clcl, hold)
return(d[-1,])
}
for (i in 1:length(smb)) {
tk = sub("^","",smb[i],fixed = TRUE)
print(tk)
s = strategy(tk)
plot(s$date,cumprod(s$opop), main=tk, type='l', col=1, ylim=c(0.3,max(c(cumprod(s$clop),cumprod(s$opop),cumprod(s$opcl)))), xlab="Date", ylab="Cum Return")
lines(s$date,cumprod(s$opcl),lwd=2, col=2)
lines(s$date,cumprod(s$clop),lwd=2, col=3)
# lines(s$date,cumprod(s$clcl),lwd=2, col=4)
legend("topleft", legend=c("buy/sell"," op/op"," op/cl"," cl/op"), col=0:3, lty=1, lwd=2)
# utils$save_pdf("~/Dropbox/proj/trade/fig/",tk)
}
utils$save_pdf("~/Dropbox/proj/trade/fig/",tk)
source("~/Dropbox/utils.R")
utils$save_pdf("~/Dropbox/proj/trade/fig/",tk)
utils$save_pdf("~/Dropbox/prj/trade/fig/",tk)
